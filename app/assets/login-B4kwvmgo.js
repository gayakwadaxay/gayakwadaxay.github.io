import{r as s,_ as re,i as te,k as se,m as R,n as q,o as ne,p as H,q as oe,t as le,v as B,w as ie,x as W,R as ce,C as X,y as de,z as ue,A as U,T as me,W as pe,E as fe,G as Z,d as he,e as be,a as ge,b as xe,f as G,g as ve,h as Ce,j as i,D as ye,F as k,I as M,B as $e}from"./index-DrEOlnL2.js";import{u as we}from"./useCompanyGet-BhCSv7vf.js";import{l as Se,L as je,v as Pe}from"./react-simple-captcha-mFr7RLV4.js";var Ee=["prefixCls","className","style","checked","disabled","defaultChecked","type","title","onChange"],Ne=s.forwardRef(function(e,a){var r=e.prefixCls,t=r===void 0?"rc-checkbox":r,n=e.className,C=e.style,g=e.checked,h=e.disabled,y=e.defaultChecked,x=y===void 0?!1:y,u=e.type,v=u===void 0?"checkbox":u,S=e.title,o=e.onChange,c=re(e,Ee),b=s.useRef(null),m=s.useRef(null),l=te(x,{value:g}),N=se(l,2),O=N[0],P=N[1];s.useImperativeHandle(a,function(){return{focus:function(f){var w;(w=b.current)===null||w===void 0||w.focus(f)},blur:function(){var f;(f=b.current)===null||f===void 0||f.blur()},input:b.current,nativeElement:m.current}});var $=R(t,n,q(q({},"".concat(t,"-checked"),O),"".concat(t,"-disabled"),h)),p=function(f){h||("checked"in e||P(f.target.checked),o==null||o({target:H(H({},e),{},{type:v,checked:f.target.checked}),stopPropagation:function(){f.stopPropagation()},preventDefault:function(){f.preventDefault()},nativeEvent:f.nativeEvent}))};return s.createElement("span",{className:$,title:S,style:C,ref:m},s.createElement("input",ne({},c,{className:"".concat(t,"-input"),ref:b,onChange:p,disabled:h,checked:!!O,type:v})),s.createElement("span",{className:"".concat(t,"-inner")}))});const Oe=e=>{const{checkboxCls:a}=e,r=`${a}-wrapper`;return[{[`${a}-group`]:Object.assign(Object.assign({},B(e)),{display:"inline-flex",flexWrap:"wrap",columnGap:e.marginXS,[`> ${e.antCls}-row`]:{flex:1}}),[r]:Object.assign(Object.assign({},B(e)),{display:"inline-flex",alignItems:"baseline",cursor:"pointer","&:after":{display:"inline-block",width:0,overflow:"hidden",content:"'\\a0'"},[`& + ${r}`]:{marginInlineStart:0},[`&${r}-in-form-item`]:{'input[type="checkbox"]':{width:14,height:14}}}),[a]:Object.assign(Object.assign({},B(e)),{position:"relative",whiteSpace:"nowrap",lineHeight:1,cursor:"pointer",borderRadius:e.borderRadiusSM,alignSelf:"center",[`${a}-input`]:{position:"absolute",inset:0,zIndex:1,cursor:"pointer",opacity:0,margin:0,[`&:focus-visible + ${a}-inner`]:Object.assign({},ie(e))},[`${a}-inner`]:{boxSizing:"border-box",display:"block",width:e.checkboxSize,height:e.checkboxSize,direction:"ltr",backgroundColor:e.colorBgContainer,border:`${W(e.lineWidth)} ${e.lineType} ${e.colorBorder}`,borderRadius:e.borderRadiusSM,borderCollapse:"separate",transition:`all ${e.motionDurationSlow}`,"&:after":{boxSizing:"border-box",position:"absolute",top:"50%",insetInlineStart:"25%",display:"table",width:e.calc(e.checkboxSize).div(14).mul(5).equal(),height:e.calc(e.checkboxSize).div(14).mul(8).equal(),border:`${W(e.lineWidthBold)} solid ${e.colorWhite}`,borderTop:0,borderInlineStart:0,transform:"rotate(45deg) scale(0) translate(-50%,-50%)",opacity:0,content:'""',transition:`all ${e.motionDurationFast} ${e.motionEaseInBack}, opacity ${e.motionDurationFast}`}},"& + span":{paddingInlineStart:e.paddingXS,paddingInlineEnd:e.paddingXS}})},{[`
        ${r}:not(${r}-disabled),
        ${a}:not(${a}-disabled)
      `]:{[`&:hover ${a}-inner`]:{borderColor:e.colorPrimary}},[`${r}:not(${r}-disabled)`]:{[`&:hover ${a}-checked:not(${a}-disabled) ${a}-inner`]:{backgroundColor:e.colorPrimaryHover,borderColor:"transparent"},[`&:hover ${a}-checked:not(${a}-disabled):after`]:{borderColor:e.colorPrimaryHover}}},{[`${a}-checked`]:{[`${a}-inner`]:{backgroundColor:e.colorPrimary,borderColor:e.colorPrimary,"&:after":{opacity:1,transform:"rotate(45deg) scale(1) translate(-50%,-50%)",transition:`all ${e.motionDurationMid} ${e.motionEaseOutBack} ${e.motionDurationFast}`}}},[`
        ${r}-checked:not(${r}-disabled),
        ${a}-checked:not(${a}-disabled)
      `]:{[`&:hover ${a}-inner`]:{backgroundColor:e.colorPrimaryHover,borderColor:"transparent"}}},{[a]:{"&-indeterminate":{[`${a}-inner`]:{backgroundColor:`${e.colorBgContainer} !important`,borderColor:`${e.colorBorder} !important`,"&:after":{top:"50%",insetInlineStart:"50%",width:e.calc(e.fontSizeLG).div(2).equal(),height:e.calc(e.fontSizeLG).div(2).equal(),backgroundColor:e.colorPrimary,border:0,transform:"translate(-50%, -50%) scale(1)",opacity:1,content:'""'}},[`&:hover ${a}-inner`]:{backgroundColor:`${e.colorBgContainer} !important`,borderColor:`${e.colorPrimary} !important`}}}},{[`${r}-disabled`]:{cursor:"not-allowed"},[`${a}-disabled`]:{[`&, ${a}-input`]:{cursor:"not-allowed",pointerEvents:"none"},[`${a}-inner`]:{background:e.colorBgContainerDisabled,borderColor:e.colorBorder,"&:after":{borderColor:e.colorTextDisabled}},"&:after":{display:"none"},"& + span":{color:e.colorTextDisabled},[`&${a}-indeterminate ${a}-inner::after`]:{background:e.colorTextDisabled}}}]};function _e(e,a){const r=le(a,{checkboxCls:`.${e}`,checkboxSize:a.controlInteractiveSize});return[Oe(r)]}const K=oe("Checkbox",(e,a)=>{let{prefixCls:r}=a;return[_e(r,e)]}),Y=ce.createContext(null);var Ie=function(e,a){var r={};for(var t in e)Object.prototype.hasOwnProperty.call(e,t)&&a.indexOf(t)<0&&(r[t]=e[t]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var n=0,t=Object.getOwnPropertySymbols(e);n<t.length;n++)a.indexOf(t[n])<0&&Object.prototype.propertyIsEnumerable.call(e,t[n])&&(r[t[n]]=e[t[n]]);return r};const ke=(e,a)=>{var r;const{prefixCls:t,className:n,rootClassName:C,children:g,indeterminate:h=!1,style:y,onMouseEnter:x,onMouseLeave:u,skipGroup:v=!1,disabled:S}=e,o=Ie(e,["prefixCls","className","rootClassName","children","indeterminate","style","onMouseEnter","onMouseLeave","skipGroup","disabled"]),{getPrefixCls:c,direction:b,checkbox:m}=s.useContext(X),l=s.useContext(Y),{isFormItemInput:N}=s.useContext(de),O=s.useContext(ue),P=(r=(l==null?void 0:l.disabled)||S)!==null&&r!==void 0?r:O,$=s.useRef(o.value);s.useEffect(()=>{l==null||l.registerValue(o.value)},[]),s.useEffect(()=>{if(!v)return o.value!==$.current&&(l==null||l.cancelValue($.current),l==null||l.registerValue(o.value),$.current=o.value),()=>l==null?void 0:l.cancelValue(o.value)},[o.value]);const p=c("checkbox",t),j=U(p),[f,w,V]=K(p,j),E=Object.assign({},o);l&&!v&&(E.onChange=function(){o.onChange&&o.onChange.apply(o,arguments),l.toggleOption&&l.toggleOption({label:g,value:o.value})},E.name=l.name,E.checked=l.value.includes(o.value));const D=R(`${p}-wrapper`,{[`${p}-rtl`]:b==="rtl",[`${p}-wrapper-checked`]:E.checked,[`${p}-wrapper-disabled`]:P,[`${p}-wrapper-in-form-item`]:N},m==null?void 0:m.className,n,C,V,j,w),z=R({[`${p}-indeterminate`]:h},me,w),T=h?"mixed":void 0;return f(s.createElement(pe,{component:"Checkbox",disabled:P},s.createElement("label",{className:D,style:Object.assign(Object.assign({},m==null?void 0:m.style),y),onMouseEnter:x,onMouseLeave:u},s.createElement(Ne,Object.assign({"aria-checked":T},E,{prefixCls:p,className:z,disabled:P,ref:a})),g!==void 0&&s.createElement("span",null,g))))},J=s.forwardRef(ke);var Re=function(e,a){var r={};for(var t in e)Object.prototype.hasOwnProperty.call(e,t)&&a.indexOf(t)<0&&(r[t]=e[t]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var n=0,t=Object.getOwnPropertySymbols(e);n<t.length;n++)a.indexOf(t[n])<0&&Object.prototype.propertyIsEnumerable.call(e,t[n])&&(r[t[n]]=e[t[n]]);return r};const Ve=s.forwardRef((e,a)=>{const{defaultValue:r,children:t,options:n=[],prefixCls:C,className:g,rootClassName:h,style:y,onChange:x}=e,u=Re(e,["defaultValue","children","options","prefixCls","className","rootClassName","style","onChange"]),{getPrefixCls:v,direction:S}=s.useContext(X),[o,c]=s.useState(u.value||r||[]),[b,m]=s.useState([]);s.useEffect(()=>{"value"in u&&c(u.value||[])},[u.value]);const l=s.useMemo(()=>n.map(d=>typeof d=="string"||typeof d=="number"?{label:d,value:d}:d),[n]),N=d=>{m(_=>_.filter(I=>I!==d))},O=d=>{m(_=>[].concat(Z(_),[d]))},P=d=>{const _=o.indexOf(d.value),I=Z(o);_===-1?I.push(d.value):I.splice(_,1),"value"in u||c(I),x==null||x(I.filter(L=>b.includes(L)).sort((L,Q)=>{const ee=l.findIndex(A=>A.value===L),ae=l.findIndex(A=>A.value===Q);return ee-ae}))},$=v("checkbox",C),p=`${$}-group`,j=U($),[f,w,V]=K($,j),E=fe(u,["value","disabled"]),D=n.length?l.map(d=>s.createElement(J,{prefixCls:$,key:d.value.toString(),disabled:"disabled"in d?d.disabled:u.disabled,value:d.value,checked:o.includes(d.value),onChange:d.onChange,className:`${p}-item`,style:d.style,title:d.title,id:d.id,required:d.required},d.label)):t,z={toggleOption:P,value:o,disabled:u.disabled,name:u.name,registerValue:O,cancelValue:N},T=R(p,{[`${p}-rtl`]:S==="rtl"},g,h,V,j,w);return f(s.createElement("div",Object.assign({className:T,style:y},E,{ref:a}),s.createElement(Y.Provider,{value:z},D)))}),F=J;F.Group=Ve;F.__ANT_CHECKBOX=!0;const De=()=>{const[e,a]=s.useState(null),r=async c=>(await be.post("/user/login",c,{headers:{"Content-Type":"application/json"}})).data,{companyData:t,companyError:n,isCompanyLoading:C,isCompanyError:g,isCompanySuccess:h}=we({token:e}),{mutate:y,data:x,error:u,isLoading:v,isError:S,isSuccess:o}=he(r,{onSuccess:c=>{var m;const b=(m=c==null?void 0:c.data)==null?void 0:m.jwt_token;a(b)}});return{mutate:y,data:x,error:u||n,isLoading:v||C,isError:S||g,isSuccess:o&&h,companyData:t}},Ae=({onLoginSuccess:e})=>{const{mutate:a,data:r,error:t,isLoading:n,isError:C,isSuccess:g,companyData:h}=De(),y=s.useRef(null),x=ge(),u=xe(),[v,S]=s.useState(""),o=c=>{Pe(v)?(c.identifier==="police"&&(c.identifier="admin"),c.identifier==="owner"&&(c.identifier="emp"),a(c)):G.error("CAPTCHA validation failed! Please try again.")};return s.useEffect(()=>{g&&(G.success("Login Success!"),u(ve(r.data.jwt_token)),u(Ce(h.data)),x("/"))},[g,r,h]),s.useEffect(()=>{C&&G.error(t.message)},[C,t]),s.useEffect(()=>{Se(4,"#000","#fff","upper")},[]),i.jsx(ye,{children:i.jsx("main",{className:"relative h-full flex flex-col justify-center bg-indigo-500 overflow-hidden px-4",children:i.jsxs("div",{className:"w-100 max-w-6xl mx-auto px-0 md:px-6 my-2 mb-12 md:py-24",children:[i.jsx("h1",{className:"text-4xl text-white pacifico-regular w-100 text-center my-5",children:"SafeGreet!"}),i.jsx("div",{className:"flex justify-center",children:i.jsxs("div",{className:"w-full mx-auto text-center bg-white px-4 sm:px-8 py-10 rounded-xl shadow",children:[i.jsxs("header",{className:"mb-8",children:[i.jsx("h1",{className:"text-2xl font-bold text-indigo-500 mb-1",children:"Login"}),i.jsx("p",{className:"text-[15px] text-slate-500",children:"Please login using your email/phone and password."})]}),i.jsxs(k,{onFinish:o,ref:y,layout:"vertical",initialValues:{remember:!0},children:[i.jsx(k.Item,{name:"identifier",label:"Email / Phone",rules:[{required:!0,message:"Please enter your email or phone number!"},{pattern:/(police)|(owner)|(admin)|(emp)|(guard)|^([6-9]\d{9}|[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,})$/,message:"Please enter a valid email / phone!"}],children:i.jsx(M,{placeholder:"Enter your email or phone",className:"w-80 px-4 border rounded-md"})}),i.jsx(k.Item,{name:"password",label:"Password",rules:[{required:!0,message:"Please enter your password!"},{min:6,message:"Password must be at least 6 characters!"}],children:i.jsx(M.Password,{placeholder:"Enter your password",className:"w-80 px-4 border rounded-md"})}),i.jsx(k.Item,{className:"flex items-center justify-center",children:i.jsxs("div",{className:"captcha-wrapper w-80",children:[i.jsx(je,{}),i.jsx(M,{placeholder:"Enter the CAPTCHA",className:"px-4 border rounded-md ",value:v,pattern:"[a-zA-Z0-9]{4}",onInput:c=>{c.target.value=c.target.value.replace(/[^a-zA-Z0-9]/g,"").toUpperCase()},onChange:c=>S(c.target.value)})]})}),i.jsx(k.Item,{name:"terms",valuePropName:"checked",rules:[{validator:(c,b)=>b?Promise.resolve():Promise.reject(new Error("You must accept the terms and conditions"))}],children:i.jsxs(F,{children:["I agree to the"," ",i.jsx("a",{href:"/terms",target:"_blank",className:"text-indigo-500",children:"Terms"})," ","and"," ",i.jsx("a",{href:"/policy",target:"_blank",className:"text-indigo-500",children:"Privacy Policy"})]})}),i.jsx($e,{htmlType:"submit",className:"w-80 mt-1 bg-indigo-500 text-white px-2 rounded-lg",disabled:n,loading:n,children:n?"Logging in...":"Login"}),i.jsx("div",{className:"text-center w-full text-slate-500 mt-1 text-[12px] ",children:i.jsx("span",{className:"cursor-pointer text-indigo-500",onClick:()=>x("/reset-password"),children:"Forgot password? Click here to reset"})})]})]})})]})})})};export{Ae as default};
